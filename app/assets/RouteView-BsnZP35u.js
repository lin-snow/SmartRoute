import{k as $,u as K,v as Q,l as f,p as P,x as b,d as j,m as M,n as W,o as v,c as E,b as e,w as a,E as X,i as _,a as U,F as q,y as B,e as I,h as Y,z as Z,s as ee,A as te,B as le,q as oe,C as ae,j as re,t as ne,D as se,f as ie,g as ue,G as N,H as de}from"./index-EnGu6XRe.js";/* empty css                        *//* empty css                 */const S=$(),H=K(),me=Q("allRoutes",()=>{const m=f([]),d=f([]),c=f(!0),y=async()=>{try{const r=await P.get("data/get");m.value=r.data.data.routes,m.value.length>0&&(console.log("Routes fetched successfully"),c.value=!1),await S.fetchCities(),d.value=C()}catch(r){console.error(r)}},C=()=>m.value.length>0&&S.allCities.length>0?m.value.slice().sort((r,n)=>n.routeId-r.routeId).map(r=>{const n=H.formatCityName(r.from.toString()),l=H.formatCityName(r.to.toString());return{...r,from:n,to:l}}):[],V=async(r,n)=>{try{if(!n.routeId)return;const l=S.allCities.find(T=>T.name==n.from.toString()),R=S.allCities.find(T=>T.name==n.to.toString()),k={routeId:n.routeId,from:l?l.cityCode:"",to:R?R.cityCode:""},h=await P.get("admin/route/delete",{params:k});h.status===200?(m.value.splice(r,1),d.value.splice(r,1),b.success("删除成功")):(console.error(h),b.error("删除失败"))}catch(l){console.error(l),b.error("删除失败")}};return y(),{allRoutes:m,formattedAllRoutes:d,fetchRoutes:y,deleteRoute:V,formatAllRoutes:C}}),pe=j({__name:"AdminRoute",setup(m){const d=me(),c=$(),y=f(),C=f(""),V=f(""),r=i=>{i&&(C.value=i[0].getHours().toString().padStart(2,"0")+":"+i[0].getMinutes().toString().padStart(2,"0"),V.value=i[1].getHours().toString().padStart(2,"0")+":"+i[1].getMinutes().toString().padStart(2,"0"))},n=f(null),l=M({from:"",to:"",vehicleType:"",vehicleCode:"",departureTime:"",arrivalTime:"",cost:"",distance:""}),R=M({from:[{required:!0,message:"Please select a departure city",trigger:"change"}],to:[{required:!0,message:"Please select a destination city",trigger:"change"}],vehicleType:[{required:!0,message:"Please select a vehicle type",trigger:"change"}],vehicleCode:[{required:!0,message:"Please enter the vehicle name",trigger:"blur"}],cost:[{required:!0,message:"Please enter the cost",trigger:"blur"},{type:"number",message:"Cost must be a number",trigger:"blur"}],distance:[{required:!0,message:"Please enter the distance",trigger:"blur"},{type:"number",message:"Distance must be a number",trigger:"blur"}]}),k=async()=>{var i;(i=n.value)==null||i.validate(async t=>{if(t)try{l.departureTime=C.value,l.arrivalTime=V.value,console.log(l),console.log("submit");const s=new FormData;s.append("from",l.from),s.append("to",l.to),s.append("vehicleType",l.vehicleType),s.append("vehicleCode",l.vehicleCode),s.append("departureTime",l.departureTime),s.append("arrivalTime",l.arrivalTime),s.append("cost",l.cost),s.append("distance",l.distance),await P.post("admin/route/add",s).then(g=>{console.log(g),c.fetchCities()}).catch(g=>{console.error("Error:",g)}),b.success("Route 添加成功"),d.fetchRoutes(),h()}catch{b.error("Route 添加失败")}else b.error("请填写正确的信息")})},h=()=>{n.value&&n.value.resetFields(),Object.assign(l,{departureCity:"",destinationCity:"",vehicleType:"",vehicleName:"",departureDate:"",arrivalTime:"",cost:null,distance:null})},T=(i,t)=>{d.deleteRoute(i,t)};return W(async()=>{await c.fetchCities(),d.fetchRoutes()}),(i,t)=>{const s=Y,g=de,A=Z,p=ee,D=te,z=le,w=oe,G=ae,x=re,O=ne,F=se,u=ie,L=ue,J=X;return v(),E("div",null,[e(J,null,{default:a(()=>[e(F,null,{default:a(()=>[e(s,null,{default:a(()=>t[7]||(t[7]=[_(" hello ")])),_:1}),e(s,null,{default:a(()=>[t[12]||(t[12]=U("h2",null,"Add Route",-1)),e(O,{ref_key:"routeFormRef",ref:n,model:l,rules:R,"label-width":"auto",style:{"max-width":"600px"}},{default:a(()=>[e(p,{label:"出发点",prop:"from"},{default:a(()=>[e(A,{modelValue:l.from,"onUpdate:modelValue":t[0]||(t[0]=o=>l.from=o),placeholder:"Please select your departure city",filterable:""},{default:a(()=>[(v(!0),E(q,null,B(I(c).allCities,o=>(v(),N(g,{key:o.cityCode,label:o.name,value:o.cityCode},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(p,{label:"目的地",prop:"to"},{default:a(()=>[e(A,{modelValue:l.to,"onUpdate:modelValue":t[1]||(t[1]=o=>l.to=o),placeholder:"Please select your destination city",filterable:""},{default:a(()=>[(v(!0),E(q,null,B(I(c).allCities,o=>(v(),N(g,{key:o.cityCode,label:o.name,value:o.cityCode},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(p,{label:"交通工具类型",prop:"vehicleType"},{default:a(()=>[e(z,{modelValue:l.vehicleType,"onUpdate:modelValue":t[2]||(t[2]=o=>l.vehicleType=o)},{default:a(()=>[e(D,{label:"0"},{default:a(()=>t[8]||(t[8]=[_("火车")])),_:1}),e(D,{label:"1"},{default:a(()=>t[9]||(t[9]=[_("飞机")])),_:1})]),_:1},8,["modelValue"])]),_:1}),e(p,{label:"班号",prop:"vehicleCode"},{default:a(()=>[e(w,{modelValue:l.vehicleCode,"onUpdate:modelValue":t[3]||(t[3]=o=>l.vehicleCode=o),placeholder:"Enter vehicle code"},null,8,["modelValue"])]),_:1}),e(p,{label:"出发和到达时间"},{default:a(()=>[e(G,{modelValue:y.value,"onUpdate:modelValue":t[4]||(t[4]=o=>y.value=o),"is-range":"","range-separator":"To","start-placeholder":"Start time","end-placeholder":"End time",format:"HH:mm",onChange:r},null,8,["modelValue"])]),_:1}),e(p,{label:"票价",prop:"cost"},{default:a(()=>[e(w,{modelValue:l.cost,"onUpdate:modelValue":t[5]||(t[5]=o=>l.cost=o),modelModifiers:{number:!0},placeholder:"Enter cost (￥)"},null,8,["modelValue"])]),_:1}),e(p,{label:"距离",prop:"distance"},{default:a(()=>[e(w,{modelValue:l.distance,"onUpdate:modelValue":t[6]||(t[6]=o=>l.distance=o),modelModifiers:{number:!0},placeholder:"Enter distance (km)"},null,8,["modelValue"])]),_:1}),e(p,null,{default:a(()=>[e(x,{type:"primary",onClick:k},{default:a(()=>t[10]||(t[10]=[_("Create")])),_:1}),e(x,{onClick:h},{default:a(()=>t[11]||(t[11]=[_("Cancel")])),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1})]),_:1}),e(F,null,{default:a(()=>[t[14]||(t[14]=U("h2",null,"Manage Route",-1)),e(L,{data:I(d).formattedAllRoutes,style:{width:"100%"},"empty-text":"no routes available!"},{default:a(()=>[e(u,{label:"Route ID",prop:"routeId"}),e(u,{label:"出发点",prop:"from"}),e(u,{label:"目的地",prop:"to"}),e(u,{label:"距离",prop:"distance"}),e(u,{label:"耗时",prop:"duration"}),e(u,{label:"费用",prop:"cost"}),e(u,{label:"交通工具",prop:"vehicleType"}),e(u,{label:"班号",prop:"vehicleCode"}),e(u,{label:"出发时间",prop:"departureTime"}),e(u,{label:"到达时间",prop:"arrivalTime"}),e(u,{label:"Actions",align:"right"},{default:a(o=>[e(x,{size:"small",type:"danger",onClick:ce=>T(o.$index,o.row)},{default:a(()=>t[13]||(t[13]=[_(" Delete ")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1})]),_:1})])}}}),ve=j({__name:"RouteView",setup(m){return(d,c)=>(v(),E("div",null,[e(pe)]))}});export{ve as default};
